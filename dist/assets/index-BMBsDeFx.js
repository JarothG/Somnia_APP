(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))d(f);new MutationObserver(f=>{for(const s of f)if(s.type==="childList")for(const t of s.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&d(t)}).observe(document,{childList:!0,subtree:!0});function o(f){const s={};return f.integrity&&(s.integrity=f.integrity),f.referrerPolicy&&(s.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?s.credentials="include":f.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function d(f){if(f.ep)return;f.ep=!0;const s=o(f);fetch(f.href,s)}})();function te(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var L,X;function re(){if(X)return L;X=1;var g={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},m=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function o(e){return e===10||e===13||e===8232||e===8233||e===32||e===9||e===11||e===12||e===160||e>=5760&&m.indexOf(e)>=0}function d(e){switch(e|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}function f(e){return(e|32)===97}function s(e){return e>=48&&e<=57}function t(e){return e>=48&&e<=57||e===43||e===45||e===46}function c(e){this.index=0,this.path=e,this.max=e.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function i(e){for(;e.index<e.max&&o(e.path.charCodeAt(e.index));)e.index++}function a(e){var u=e.path.charCodeAt(e.index);if(u===48){e.param=0,e.index++;return}if(u===49){e.param=1,e.index++;return}e.err="SvgPath: arc flag can be 0 or 1 only (at pos "+e.index+")"}function h(e){var u=e.index,n=u,p=e.max,y=!1,v=!1,w=!1,_=!1,x;if(n>=p){e.err="SvgPath: missed param (at pos "+n+")";return}if(x=e.path.charCodeAt(n),(x===43||x===45)&&(n++,x=n<p?e.path.charCodeAt(n):0),!s(x)&&x!==46){e.err="SvgPath: param should start with 0..9 or `.` (at pos "+n+")";return}if(x!==46){if(y=x===48,n++,x=n<p?e.path.charCodeAt(n):0,y&&n<p&&x&&s(x)){e.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+u+")";return}for(;n<p&&s(e.path.charCodeAt(n));)n++,v=!0;x=n<p?e.path.charCodeAt(n):0}if(x===46){for(_=!0,n++;s(e.path.charCodeAt(n));)n++,w=!0;x=n<p?e.path.charCodeAt(n):0}if(x===101||x===69){if(_&&!v&&!w){e.err="SvgPath: invalid float exponent (at pos "+n+")";return}if(n++,x=n<p?e.path.charCodeAt(n):0,(x===43||x===45)&&n++,n<p&&s(e.path.charCodeAt(n)))for(;n<p&&s(e.path.charCodeAt(n));)n++;else{e.err="SvgPath: invalid float exponent (at pos "+n+")";return}}e.index=n,e.param=parseFloat(e.path.slice(u,n))+0}function l(e){var u,n;u=e.path[e.segmentStart],n=u.toLowerCase();var p=e.data;if(n==="m"&&p.length>2&&(e.result.push([u,p[0],p[1]]),p=p.slice(2),n="l",u=u==="m"?"l":"L"),n==="r")e.result.push([u].concat(p));else for(;p.length>=g[n]&&(e.result.push([u].concat(p.splice(0,g[n]))),!!g[n]););}function r(e){var u=e.max,n,p,y,v,w;if(e.segmentStart=e.index,n=e.path.charCodeAt(e.index),p=f(n),!d(n)){e.err="SvgPath: bad command "+e.path[e.index]+" (at pos "+e.index+")";return}if(v=g[e.path[e.index].toLowerCase()],e.index++,i(e),e.data=[],!v){l(e);return}for(y=!1;;){for(w=v;w>0;w--){if(p&&(w===3||w===4)?a(e):h(e),e.err.length){l(e);return}e.data.push(e.param),i(e),y=!1,e.index<u&&e.path.charCodeAt(e.index)===44&&(e.index++,i(e),y=!0)}if(!y&&(e.index>=e.max||!t(e.path.charCodeAt(e.index))))break}l(e)}return L=function(u){var n=new c(u),p=n.max;for(i(n);n.index<p&&!n.err.length;)r(n);return n.result.length&&("mM".indexOf(n.result[0][0])<0?(n.err="SvgPath: string should start with `M` or `m`",n.result=[]):n.result[0][0]="M"),{err:n.err,segments:n.result}},L}var I,V;function Z(){if(V)return I;V=1;function g(o,d){return[o[0]*d[0]+o[2]*d[1],o[1]*d[0]+o[3]*d[1],o[0]*d[2]+o[2]*d[3],o[1]*d[2]+o[3]*d[3],o[0]*d[4]+o[2]*d[5]+o[4],o[1]*d[4]+o[3]*d[5]+o[5]]}function m(){if(!(this instanceof m))return new m;this.queue=[],this.cache=null}return m.prototype.matrix=function(o){return o[0]===1&&o[1]===0&&o[2]===0&&o[3]===1&&o[4]===0&&o[5]===0?this:(this.cache=null,this.queue.push(o),this)},m.prototype.translate=function(o,d){return(o!==0||d!==0)&&(this.cache=null,this.queue.push([1,0,0,1,o,d])),this},m.prototype.scale=function(o,d){return(o!==1||d!==1)&&(this.cache=null,this.queue.push([o,0,0,d,0,0])),this},m.prototype.rotate=function(o,d,f){var s,t,c;return o!==0&&(this.translate(d,f),s=o*Math.PI/180,t=Math.cos(s),c=Math.sin(s),this.queue.push([t,c,-c,t,0,0]),this.cache=null,this.translate(-d,-f)),this},m.prototype.skewX=function(o){return o!==0&&(this.cache=null,this.queue.push([1,0,Math.tan(o*Math.PI/180),1,0,0])),this},m.prototype.skewY=function(o){return o!==0&&(this.cache=null,this.queue.push([1,Math.tan(o*Math.PI/180),0,1,0,0])),this},m.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],this.queue.length===1)return this.cache;for(var o=1;o<this.queue.length;o++)this.cache=g(this.cache,this.queue[o]);return this.cache},m.prototype.calc=function(o,d,f){var s;return this.queue.length?(this.cache||(this.cache=this.toArray()),s=this.cache,[o*s[0]+d*s[2]+(f?0:s[4]),o*s[1]+d*s[3]+(f?0:s[5])]):[o,d]},I=m,I}var N,j;function ae(){if(j)return N;j=1;var g=Z(),m={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},o=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,d=/[\s,]+/;return N=function(s){var t=new g,c,i;return s.split(o).forEach(function(a){if(a.length){if(typeof m[a]<"u"){c=a;return}switch(i=a.split(d).map(function(h){return+h||0}),c){case"matrix":i.length===6&&t.matrix(i);return;case"scale":i.length===1?t.scale(i[0],i[0]):i.length===2&&t.scale(i[0],i[1]);return;case"rotate":i.length===1?t.rotate(i[0],0,0):i.length===3&&t.rotate(i[0],i[1],i[2]);return;case"translate":i.length===1?t.translate(i[0],0):i.length===2&&t.translate(i[0],i[1]);return;case"skewX":i.length===1&&t.skewX(i[0]);return;case"skewY":i.length===1&&t.skewY(i[0]);return}}}),t},N}var T,H;function ne(){if(H)return T;H=1;var g=Math.PI*2;function m(f,s,t,c){var i=f*c-s*t<0?-1:1,a=f*t+s*c;return a>1&&(a=1),a<-1&&(a=-1),i*Math.acos(a)}function o(f,s,t,c,i,a,h,l,r,e){var u=e*(f-t)/2+r*(s-c)/2,n=-r*(f-t)/2+e*(s-c)/2,p=h*h,y=l*l,v=u*u,w=n*n,_=p*y-p*w-y*v;_<0&&(_=0),_/=p*w+y*v,_=Math.sqrt(_)*(i===a?-1:1);var x=_*h/l*n,b=_*-l/h*u,E=e*x-r*b+(f+t)/2,P=r*x+e*b+(s+c)/2,S=(u-x)/h,A=(n-b)/l,M=(-u-x)/h,k=(-n-b)/l,D=m(1,0,S,A),C=m(S,A,M,k);return a===0&&C>0&&(C-=g),a===1&&C<0&&(C+=g),[E,P,D,C]}function d(f,s){var t=1.3333333333333333*Math.tan(s/4),c=Math.cos(f),i=Math.sin(f),a=Math.cos(f+s),h=Math.sin(f+s);return[c,i,c-i*t,i+c*t,a+h*t,h-a*t,a,h]}return T=function(s,t,c,i,a,h,l,r,e){var u=Math.sin(e*g/360),n=Math.cos(e*g/360),p=n*(s-c)/2+u*(t-i)/2,y=-u*(s-c)/2+n*(t-i)/2;if(p===0&&y===0)return[];if(l===0||r===0)return[];l=Math.abs(l),r=Math.abs(r);var v=p*p/(l*l)+y*y/(r*r);v>1&&(l*=Math.sqrt(v),r*=Math.sqrt(v));var w=o(s,t,c,i,a,h,l,r,u,n),_=[],x=w[2],b=w[3],E=Math.max(Math.ceil(Math.abs(b)/(g/4)),1);b/=E;for(var P=0;P<E;P++)_.push(d(x,b)),x+=b;return _.map(function(S){for(var A=0;A<S.length;A+=2){var M=S[A+0],k=S[A+1];M*=l,k*=r;var D=n*M-u*k,C=u*M+n*k;S[A+0]=D+w[0],S[A+1]=C+w[1]}return S})},T}var O,z;function ie(){if(z)return O;z=1;var g=1e-10,m=Math.PI/180;function o(d,f,s){if(!(this instanceof o))return new o(d,f,s);this.rx=d,this.ry=f,this.ax=s}return o.prototype.transform=function(d){var f=Math.cos(this.ax*m),s=Math.sin(this.ax*m),t=[this.rx*(d[0]*f+d[2]*s),this.rx*(d[1]*f+d[3]*s),this.ry*(-d[0]*s+d[2]*f),this.ry*(-d[1]*s+d[3]*f)],c=t[0]*t[0]+t[2]*t[2],i=t[1]*t[1]+t[3]*t[3],a=((t[0]-t[3])*(t[0]-t[3])+(t[2]+t[1])*(t[2]+t[1]))*((t[0]+t[3])*(t[0]+t[3])+(t[2]-t[1])*(t[2]-t[1])),h=(c+i)/2;if(a<g*h)return this.rx=this.ry=Math.sqrt(h),this.ax=0,this;var l=t[0]*t[1]+t[2]*t[3];a=Math.sqrt(a);var r=h+a/2,e=h-a/2;return this.ax=Math.abs(l)<g&&Math.abs(r-i)<g?90:Math.atan(Math.abs(l)>Math.abs(r-i)?(r-c)/l:l/(r-i))*180/Math.PI,this.ax>=0?(this.rx=Math.sqrt(r),this.ry=Math.sqrt(e)):(this.ax+=90,this.rx=Math.sqrt(e),this.ry=Math.sqrt(r)),this},o.prototype.isDegenerate=function(){return this.rx<g*this.ry||this.ry<g*this.rx},O=o,O}var R,G;function oe(){if(G)return R;G=1;var g=re(),m=ae(),o=Z(),d=ne(),f=ie();function s(t){if(!(this instanceof s))return new s(t);var c=g(t);this.segments=c.segments,this.err=c.err,this.__stack=[]}return s.from=function(t){if(typeof t=="string")return new s(t);if(t instanceof s){var c=new s("");return c.err=t.err,c.segments=t.segments.map(function(i){return i.slice()}),c.__stack=t.__stack.map(function(i){return o().matrix(i.toArray())}),c}throw new Error("SvgPath.from: invalid param type "+t)},s.prototype.__matrix=function(t){var c=this,i;t.queue.length&&this.iterate(function(a,h,l,r){var e,u,n,p;switch(a[0]){case"v":e=t.calc(0,a[1],!0),u=e[0]===0?["v",e[1]]:["l",e[0],e[1]];break;case"V":e=t.calc(l,a[1],!1),u=e[0]===t.calc(l,r,!1)[0]?["V",e[1]]:["L",e[0],e[1]];break;case"h":e=t.calc(a[1],0,!0),u=e[1]===0?["h",e[0]]:["l",e[0],e[1]];break;case"H":e=t.calc(a[1],r,!1),u=e[1]===t.calc(l,r,!1)[1]?["H",e[0]]:["L",e[0],e[1]];break;case"a":case"A":var y=t.toArray(),v=f(a[1],a[2],a[3]).transform(y);if(y[0]*y[3]-y[1]*y[2]<0&&(a[5]=a[5]?"0":"1"),e=t.calc(a[6],a[7],a[0]==="a"),a[0]==="A"&&a[6]===l&&a[7]===r||a[0]==="a"&&a[6]===0&&a[7]===0){u=[a[0]==="a"?"l":"L",e[0],e[1]];break}v.isDegenerate()?u=[a[0]==="a"?"l":"L",e[0],e[1]]:u=[a[0],v.rx,v.ry,v.ax,a[4],a[5],e[0],e[1]];break;case"m":p=h>0,e=t.calc(a[1],a[2],p),u=["m",e[0],e[1]];break;default:for(n=a[0],u=[n],p=n.toLowerCase()===n,i=1;i<a.length;i+=2)e=t.calc(a[i],a[i+1],p),u.push(e[0],e[1])}c.segments[h]=u},!0)},s.prototype.__evaluateStack=function(){var t,c;if(this.__stack.length){if(this.__stack.length===1){this.__matrix(this.__stack[0]),this.__stack=[];return}for(t=o(),c=this.__stack.length;--c>=0;)t.matrix(this.__stack[c].toArray());this.__matrix(t),this.__stack=[]}},s.prototype.toString=function(){var t="",c="",i=!1;this.__evaluateStack();for(var a=0,h=this.segments.length;a<h;a++){var l=this.segments[a],r=l[0];r!==c||r==="m"||r==="M"?(r==="m"&&c==="z"&&(t+=" "),t+=r,i=!1):i=!0;for(var e=1;e<l.length;e++){var u=l[e];e===1?i&&u>=0&&(t+=" "):u>=0&&(t+=" "),t+=u}c=r}return t},s.prototype.translate=function(t,c){return this.__stack.push(o().translate(t,c||0)),this},s.prototype.scale=function(t,c){return this.__stack.push(o().scale(t,!c&&c!==0?t:c)),this},s.prototype.rotate=function(t,c,i){return this.__stack.push(o().rotate(t,c||0,i||0)),this},s.prototype.skewX=function(t){return this.__stack.push(o().skewX(t)),this},s.prototype.skewY=function(t){return this.__stack.push(o().skewY(t)),this},s.prototype.matrix=function(t){return this.__stack.push(o().matrix(t)),this},s.prototype.transform=function(t){return t.trim()?(this.__stack.push(m(t)),this):this},s.prototype.round=function(t){var c=0,i=0,a=0,h=0,l;return t=t||0,this.__evaluateStack(),this.segments.forEach(function(r){var e=r[0].toLowerCase()===r[0];switch(r[0]){case"H":case"h":e&&(r[1]+=a),a=r[1]-r[1].toFixed(t),r[1]=+r[1].toFixed(t);return;case"V":case"v":e&&(r[1]+=h),h=r[1]-r[1].toFixed(t),r[1]=+r[1].toFixed(t);return;case"Z":case"z":a=c,h=i;return;case"M":case"m":e&&(r[1]+=a,r[2]+=h),a=r[1]-r[1].toFixed(t),h=r[2]-r[2].toFixed(t),c=a,i=h,r[1]=+r[1].toFixed(t),r[2]=+r[2].toFixed(t);return;case"A":case"a":e&&(r[6]+=a,r[7]+=h),a=r[6]-r[6].toFixed(t),h=r[7]-r[7].toFixed(t),r[1]=+r[1].toFixed(t),r[2]=+r[2].toFixed(t),r[3]=+r[3].toFixed(t+2),r[6]=+r[6].toFixed(t),r[7]=+r[7].toFixed(t);return;default:l=r.length,e&&(r[l-2]+=a,r[l-1]+=h),a=r[l-2]-r[l-2].toFixed(t),h=r[l-1]-r[l-1].toFixed(t),r.forEach(function(u,n){n&&(r[n]=+r[n].toFixed(t))});return}}),this},s.prototype.iterate=function(t,c){var i=this.segments,a={},h=!1,l=0,r=0,e=0,u=0,n,p,y;if(c||this.__evaluateStack(),i.forEach(function(v,w){var _=t(v,w,l,r);Array.isArray(_)&&(a[w]=_,h=!0);var x=v[0]===v[0].toLowerCase();switch(v[0]){case"m":case"M":l=v[1]+(x?l:0),r=v[2]+(x?r:0),e=l,u=r;return;case"h":case"H":l=v[1]+(x?l:0);return;case"v":case"V":r=v[1]+(x?r:0);return;case"z":case"Z":l=e,r=u;return;default:l=v[v.length-2]+(x?l:0),r=v[v.length-1]+(x?r:0)}}),!h)return this;for(y=[],n=0;n<i.length;n++)if(typeof a[n]<"u")for(p=0;p<a[n].length;p++)y.push(a[n][p]);else y.push(i[n]);return this.segments=y,this},s.prototype.abs=function(){return this.iterate(function(t,c,i,a){var h=t[0],l=h.toUpperCase(),r;if(h!==l)switch(t[0]=l,h){case"v":t[1]+=a;return;case"a":t[6]+=i,t[7]+=a;return;default:for(r=1;r<t.length;r++)t[r]+=r%2?i:a}},!0),this},s.prototype.rel=function(){return this.iterate(function(t,c,i,a){var h=t[0],l=h.toLowerCase(),r;if(h!==l&&!(c===0&&h==="M"))switch(t[0]=l,h){case"V":t[1]-=a;return;case"A":t[6]-=i,t[7]-=a;return;default:for(r=1;r<t.length;r++)t[r]-=r%2?i:a}},!0),this},s.prototype.unarc=function(){return this.iterate(function(t,c,i,a){var h,l,r,e=[],u=t[0];return u!=="A"&&u!=="a"?null:(u==="a"?(l=i+t[6],r=a+t[7]):(l=t[6],r=t[7]),h=d(i,a,l,r,t[4],t[5],t[1],t[2],t[3]),h.length===0?[[t[0]==="a"?"l":"L",t[6],t[7]]]:(h.forEach(function(n){e.push(["C",n[2],n[3],n[4],n[5],n[6],n[7]])}),e))}),this},s.prototype.unshort=function(){var t=this.segments,c,i,a,h,l;return this.iterate(function(r,e,u,n){var p=r[0],y=p.toUpperCase(),v;e&&(y==="T"?(v=p==="t",a=t[e-1],a[0]==="Q"?(c=a[1]-u,i=a[2]-n):a[0]==="q"?(c=a[1]-a[3],i=a[2]-a[4]):(c=0,i=0),h=-c,l=-i,v||(h+=u,l+=n),t[e]=[v?"q":"Q",h,l,r[1],r[2]]):y==="S"&&(v=p==="s",a=t[e-1],a[0]==="C"?(c=a[3]-u,i=a[4]-n):a[0]==="c"?(c=a[3]-a[5],i=a[4]-a[6]):(c=0,i=0),h=-c,l=-i,v||(h+=u,l+=n),t[e]=[v?"c":"C",h,l,r[1],r[2],r[3],r[4]]))}),this},R=s,R}var B,U;function se(){return U||(U=1,B=oe()),B}var le=se();const ce=te(le);async function he(g){const m=`
    Dream Narrative: ${g}, 
    Analyze the detailed dream narrative provided above. 
    Your response should be a JSON object containing the following keys:

'symbol_pattern_numerical': 
    An array of exactly four integers. These integers should correspond to the dream symbols from the following numbered list: (1. trapped, 2. alien, 3. Nakedness, 4. Missed Events, 5. Snakes, 6. Love, 7. Nature, 8. Endless Paths, 9. Dark Figures, 10. Animals, 11. Sleep Paralysis, 12. Flying, 13. Spirits, 14. Natural disaster, 15. Falling teeth, 16. Survival, 17. Doors, 18. Chased, 19. Falling, 20. Family, 21. Late, 22. Money, 23. Vehicle accident, 24. Home, 25. School, 26. Dying, 27. Childhood, 28. Violence, 29. Insects, 30. Sight). 
    The composition of this array must adhere to one of two structures: either a pair of numbers repeated twice, or four entirely different numbers, never only 3 different numbers! Choose the symbols that most closely align with the elements and emotions described in the dream.

'symbol_pattern_textual': An array of four strings. Each string should be the textual description of the corresponding numerical symbol in the 'symbol_pattern_numerical' array, maintaining the same order.

'color_gradient': An array containing precisely two hexadecimal color codes. These codes should represent the start and end points of a visual gradient intended to reflect the emotional arc of the dream. The colors must strictly be randomly selected from the following color palette (blue: #76CEDC, red: #FF6048, yellow: #FFE551, pink: #FF98C1). For dreams identified as predominantly positive or negative, the gradient should consist of two different shades (lighter and darker) of the color associated with that primary emotion. For dreams with a clear shift in emotion (mixed dreams), the gradient should transition between two distinct colors from the palette, representing the initial and subsequent emotional states. 

'emotion_analysis': A string that classifies the overall emotional tone of the dream. The possible values for this key are: 'Positive dream', 'Negative dream', or 'Mixed dream'. Base this classification on the predominant feelings and the narrative progression within the dream.

'dream_analysis': A string that provides a brief analysis of the dream's narrative, including its emotional tone and any significant symbols or themes. This analysis should be concise, no more than 2-3 sentences, and should reflect the overall interpretation of the dream based on the provided elements.

'realism_assessment': A string that classifies the dream's realism as 'Realistic', 'Slightly unrealistic', or 'Unrealistic'. Base this on the plausibility of the dream events in waking reality.

'realism_value': an integer corresponding to the realism_assessment, where 0 is "Realistic", 1 is "'Slightly unrealistic', and 2 is 'Unrealistic'. 

'realism_analysis': A string that provides a brief explanation for the assigned realism assessment, highlighting the specific elements of the dream that contribute to its level of realism or lack thereof.,
    example_json_output: {
        "symbol_pattern_numerical": [23, 23, 26, 26],
        "symbol_pattern_textual": ["Vehicle accident", "Vehicle accident", "Dying", "Dying"],
        "color_gradient": ["#FF6048", "#B23C2D"],
        "emotion_analysis": "Negative dream",
        "dream_analysis": "The dream depicts a sudden and violent event ('Vehicle accident') caused by a loved one's reckless action, leading to a fatal outcome ('Dying'). The color gradient reflects the negative emotions of fear, shock, and the finality of death, moving from a lighter to a darker shade of red.",
        "realism_assessment": "Unrealistic",
        "realism_value": 2,
        "realism_analysis": "While car accidents are a real occurrence, the detail of the mother violently pressing the gas pedal and the immediate assumption of death introduce a somewhat dramatic and exaggerated element often found in dreams."
    }
    
    **Note:** The JSON object must be valid and well-structured. Do not include any additional text or explanations outside of the JSON object.
    """
`;try{const o=await fetch("https://dream-server-g2e3.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:m})});if(!o.ok)throw new Error("Server error");return await o.json()}catch(o){return console.error(o),{error:"Failed to generate response"}}}const F=document.getElementById("grid"),W=document.querySelector(".grid-container"),J=document.querySelector(".analysis-container"),ue=document.getElementById("downloadBtn"),q=document.getElementById("dreamInput"),Y=document.getElementById("renderDreamBtn");Y.addEventListener("click",me);const $=4,fe=5,K=200,Q=0,de=30,pe=Array.from({length:de},(g,m)=>`${String(m+1).padStart(2,"0")}.svg`);async function me(){const g=q.value.trim();if(!g){alert("Please enter a search query");return}W.style.display="none",ge();try{const m=await he(g);console.log("AI Response:",m),ye(m.colorGradient,m.symbols,m.pattern),J.innerHTML="",J.innerHTML+=JSON.stringify(m)}catch(m){console.error("Error fetching response:",m),alert("Error fetching response. Please try again.")}finally{ve()}}function ge(){Y.style.display="none",document.getElementById("loadingIndicator").style.display="flex"}function ve(){Y.style.display="block",document.getElementById("loadingIndicator").style.display="none"}async function xe(g){const o=await(await fetch("/symbols/"+g)).text(),f=new DOMParser().parseFromString(o,"image/svg+xml").querySelector("svg");if(!f)throw new Error(`Invalid SVG in ${g}`);return f}async function ye(g,m,o){if(!m||m.length===0){console.error("No symbols selected");return}if(!o||o<0||o>2){console.error("Invalid pattern selected");return}if(!g||g.length<2){console.error("Invalid color gradient");return}W.style.display="flex",F.innerHTML="";const d=m.map(l=>pe[l-1]),f=await Promise.all(d.map(xe));let s="";for(let l=0;l<fe;l++){let r=[];if(o===0){const e=l%f.length;r=Array($).fill(e)}else o===1?r=l%2===0?[0,1,2,3]:[3,2,1,0]:o===2&&(r=l%2===0?[0,1,2,3]:[2,3,0,1]);for(let e=0;e<$;e++){const u=e*(K+Q),n=l*(K+Q),p=r[e%r.length]%f.length;f[p].querySelectorAll("path").forEach(w=>{const _=w.getAttribute("d");if(!_)return;const x=ce(_).translate(u,n).toString();s+=x+" "})}}const t=document.createElementNS("http://www.w3.org/2000/svg","defs"),c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","myGradient"),c.setAttribute("gradientTransform","rotate(90)");const i=document.createElementNS("http://www.w3.org/2000/svg","stop");i.setAttribute("offset","5%"),i.setAttribute("stop-color",g[0]);const a=document.createElementNS("http://www.w3.org/2000/svg","stop");a.setAttribute("offset","95%"),a.setAttribute("stop-color",g[1]),c.appendChild(i),c.appendChild(a),t.appendChild(c);const h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",s),h.setAttribute("fill","url(#myGradient)"),F.appendChild(t),F.appendChild(h)}ue.addEventListener("click",async()=>{const{jsPDF:g}=window.jspdf,m=new g({orientation:"portrait",unit:"pt",format:[800,1e3]});m.svg(F,{xOffset:0,yOffset:0,scale:1}).then(()=>{m.save("svg-grid.pdf")})});const ee=()=>{q.style.height="auto",q.style.height=q.scrollHeight-4+"px"};q.addEventListener("input",ee);ee();
